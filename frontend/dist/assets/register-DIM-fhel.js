import"./style-BpaiFPrc.js";document.addEventListener("DOMContentLoaded",function(){var r;(r=a())==null||r.addEventListener("submit",h)});function o(r){return document.getElementById(r)}function a(){return o("registerForm")}function u(){["usernameError","emailError","passwordError","confirmError"].map(o).filter(Boolean).forEach(function(r){r.classList.add("hidden")})}function c(r,e){const n=o(r);n&&(n.textContent=e,n.classList.remove("hidden"))}function m(){var r,e,n,t;return{username:(r=o("username"))==null?void 0:r.value.trim(),email:(e=o("email"))==null?void 0:e.value.trim(),password:(n=o("password"))==null?void 0:n.value.trim(),confirm:(t=o("confirmPassword"))==null?void 0:t.value.trim()}}function d(r){return[!r.username&&["usernameError","Nom requis"],!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)&&["emailError","Email invalide"],!r.password&&["passwordError","Mot de passe requis"],r.password!==r.confirm&&["confirmError","Les mots de passe ne correspondent pas"]].filter(Boolean)}function i(r,e){return fetch(r,e).then(function(n){return n.json().then(function(t){return n.ok?t:Promise.reject(new Error(t.error||"Erreur"))})})}function f(){return i("http://localhost:5000/api/csrf-token",{credentials:"include"}).then(function(r){return r.csrfToken})}function l(r,e){return i("http://localhost:5000/api/auth/register",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","CSRF-Token":e},body:JSON.stringify(r)})}function h(r){r.preventDefault(),u();const e=m(),n=d(e);if(n.length>0){n.forEach(function([t,s]){c(t,s)});return}f().then(function(t){return l({username:e.username,email:e.email,password:e.password},t)}).then(function(){alert("Inscription r√©ussie !"),r.target.reset(),window.location.href="/login.html"}).catch(function(t){alert(t.message),console.error(t)})}
