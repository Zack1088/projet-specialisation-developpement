import"./style-BpaiFPrc.js";document.addEventListener("DOMContentLoaded",function(){const e=o("loginForm");e&&e.addEventListener("submit",f)});function o(e){return document.getElementById(e)}function a(){var e,n;(e=o("emailError"))==null||e.classList.add("hidden"),(n=o("passwordError"))==null||n.classList.add("hidden")}function c(e,n){const t=o(e);t&&(t.textContent=n,t.classList.remove("hidden"))}function u(e,n){return fetch(e,n).then(function(t){return t.json().then(function(i){return t.ok?i:Promise.reject(new Error(i.error||"Erreur inconnue"))})})}function l(){return u("http://localhost:5000/api/csrf-token",{credentials:"include"}).then(function(e){return e.csrfToken})}function d(e,n){return u("http://localhost:5000/api/auth/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","CSRF-Token":n},body:JSON.stringify(e)})}function f(e){var i,s;e.preventDefault(),a();const n=(i=o("email"))==null?void 0:i.value.trim(),t=(s=o("password"))==null?void 0:s.value.trim();if(!n)return c("emailError","Veuillez entrer votre email");if(!t)return c("passwordError","Veuillez entrer votre mot de passe");l().then(function(r){return d({email:n,password:t},r)}).then(function(r){console.log("✅ Connexion réussie :",r),alert("Connexion réussie !"),window.location.href="/dashboard.html"}).catch(function(r){console.error("Erreur de login :",r),alert(r.message)})}
